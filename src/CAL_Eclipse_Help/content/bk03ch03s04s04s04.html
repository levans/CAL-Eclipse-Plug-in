<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Foreign function definitions for Java casts</title><link href="../eclipsehelp.css" rel="stylesheet" type="text/css"><meta content="DocBook XSL Stylesheets V1.71.1" name="generator"><link rel="start" href="index.html" title="CAL Development Guide"><link rel="up" href="bk03ch03s04s04.html" title="Foreign definitions"><link rel="prev" href="bk03ch03s04s04s03.html" title="Foreign function definitions for Java fields"><link rel="next" href="bk03ch03s04s04s05.html" title="Foreign function definitions for Java instanceof operator calls"><link rel="preface" href="bk01pr01.html" title="Overview"><link rel="chapter" href="bk01ch01.html" title="Chapter&nbsp;1.&nbsp;Installing the CAL Eclipse Plug-in"><link rel="chapter" href="bk01ch02.html" title="Chapter&nbsp;2.&nbsp;Setting up Eclipse for CAL"><link rel="chapter" href="bk01ch03.html" title="Chapter&nbsp;3.&nbsp;Tutorial: Hello World"><link rel="chapter" href="bk01ch04.html" title="Chapter&nbsp;4.&nbsp;Using the CAL Eclipse Plug-in"><link rel="article" href="bk02ar01.html" title="CAL for Haskell Programmers"><link rel="article" href="bk02ar02.html" title="Effective CAL"><link rel="chapter" href="Overview.html" title="Chapter&nbsp;1.&nbsp;Overview"><link rel="chapter" href="bk03ch02.html" title="Chapter&nbsp;2.&nbsp;Getting Started with CAL"><link rel="chapter" href="bk03ch03.html" title="Chapter&nbsp;3.&nbsp;Language Reference"><link rel="chapter" href="bk03ch04.html" title="Chapter&nbsp;4.&nbsp;Standard Library Reference"><link rel="appendix" href="bk03apa.html" title="Appendix&nbsp;A.&nbsp;CAL source formatting conventions"><link rel="appendix" href="bk03apb.html" title="Appendix&nbsp;B.&nbsp;Suggested reading"><link rel="appendix" href="bk03apc.html" title="Appendix&nbsp;C.&nbsp;Language keywords"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table summary="Navigation header" width="100%"><tr><th align="center" colspan="3">Foreign function definitions for Java casts</th></tr><tr><td align="left" width="20%"><a accesskey="p" href="bk03ch03s04s04s03.html">Prev</a>&nbsp;</td><th align="center" width="60%">Foreign definitions</th><td align="right" width="20%">&nbsp;<a accesskey="n" href="bk03ch03s04s04s05.html">Next</a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="N23CA3"></a>Foreign function definitions for Java casts</h4></div></div></div>
          

          <p>Java casts can be imported into CAL using the <code class="code">foreign unsafe import jvm</code>
          construct. You can use "cast" to convert between any two CAL types that are foreign types
          such that there is a legal Java conversion between the two types.</p>

          <p>Here is an example from the <code class="classname">Prelude</code> module. In this case, the
          Java implementation types are <code class="type">byte</code> and <code class="type">float</code>. There is a legal
          Java cast between these two types so this declaration is allowed by CAL.<div class="informalexample">
              <pre class="programlisting">foreign unsafe import jvm "cast"
    byteToFloat :: Byte -&gt; Float;</pre>
            </div></p>

          <p>Here is another example from the <code class="classname">Prelude</code> module. In this
          case, the Java implementation types are <code class="classname">java.util.List</code> and
          <code class="classname">java.util.ArrayList</code>. There is a legal Java cast between these two
          types so this declaration is allowed by CAL.<div class="informalexample">
              <pre class="programlisting">foreign unsafe import jvm "cast"
    listToArrayList :: JList -&gt; JArrayList;</pre>
            </div></p>

          <p>"cast" works for any legal Java cast, including identity casts, widening and
          narrowing primitive casts, and widening and narrowing reference casts. The actual rules
          for when you can do this are somewhat technical and described in section 2.6 of the JVM
          specification. The CAL compiler will take care of producing optimal Java code for what you
          have done e.g. narrowing reference casts compile down to uses of the Java cast operator,
          primitive casts compile down to uses of JVM primitive conversion operations, identity and
          widening reference casts are no-ops.</p>
        </div><div class="navfooter"><hr><table summary="Navigation footer" width="100%"><tr><td align="left" width="40%"><a accesskey="p" href="bk03ch03s04s04s03.html">Prev</a>&nbsp;</td><td align="center" width="20%"><a accesskey="u" href="bk03ch03s04s04.html">Up</a></td><td align="right" width="40%">&nbsp;<a accesskey="n" href="bk03ch03s04s04s05.html">Next</a></td></tr><tr><td valign="top" align="left" width="40%">Foreign function definitions for Java fields&nbsp;</td><td align="center" width="20%"><a accesskey="h" href="index.html">Home</a></td><td valign="top" align="right" width="40%">&nbsp;Foreign function definitions for Java instanceof operator calls</td></tr></table></div></body></html>